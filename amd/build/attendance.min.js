define("local_apsolu/attendance",["jquery","enrol_select/jquery.popupoverlay"],(function($){return{initialise:function(){function apsolu_attendance_handle_edit_enrolments_form(){$("#apsolu-attendance-ajax-edit-enrolment form").submit((function(event){event.preventDefault();var popup=document.querySelector("#apsolu-attendance-popup .alert");null!==popup&&popup.remove(),$.ajax({url:M.cfg.wwwroot+"/local/apsolu/attendance/ajax/edit_enrolment.php",type:"POST",data:$("#apsolu-attendance-ajax-edit-enrolment form").serialize(),dataType:"json"}).done((function(result){$("#apsolu-attendance-popup").html(result.form);var status=$(".apsolu-attendance-status[data-userid="+result.userid+"]");1==status.length&&(status.html(result.status),$(".apsolu-attendance-edit-enrolments[data-userid="+result.userid+"]").data("statusid",result.statusid));var role=$(".apsolu-attendance-role[data-userid="+result.userid+"]");1==role.length&&(role.html(result.role),$(".apsolu-attendance-edit-enrolments[data-userid="+result.userid+"]").data("roleid",result.roleid)),apsolu_attendance_handle_edit_enrolments_form()}))})),$("#apsolu-attendance-ajax-edit-enrolment form .cancel").click((function(event){event.preventDefault(),$("#apsolu-attendance-popup").popup("hide")}))}$("#apsolu-attendance-table").before('<div id="apsolu-attendance-check-javascript-helper" class="text-right"><p>Pour les présences <u>non saisies</u> :<ul class="list-inline"><li class="list-inline-item"><span class="btn btn-sm btn-primary" id="apsolu-check-radio-present">Cocher "présent" pour tous</span></li><li class="list-inline-item"><span class="btn btn-sm btn-primary" id="apsolu-check-radio-absent">Cocher "absent" pour tous</span></li><li class="list-inline-item"><span class="btn btn-sm btn-dark" id="apsolu-check-radio-uncheck">Décocher toutes les cases</span></li></ul></div>'),$("#apsolu-check-radio-present").click((function(){$("#apsolu-attendance-table tbody tr").each((function(){0==$(this).find("input[type=radio]:checked").length&&$(this).find("input[type=radio]").first().prop("checked",!0)}))})),$("#apsolu-check-radio-absent").click((function(){$("#apsolu-attendance-table tbody tr").each((function(){0==$(this).find("input[type=radio]:checked").length&&$(this).find("input[type=radio]").last().prop("checked",!0)}))})),$("#apsolu-check-radio-uncheck").click((function(){$("#apsolu-attendance-table tbody tr").each((function(){0!=$(this).find("input[type=radio]:checked").length&&$(this).find("input[type=radio]").prop("checked",!1)}))})),$("#apsolu-attendance-table tbody tr input[type=radio]").click((function(){var name=$(this).attr("name");$('#apsolu-attendance-table tbody tr input[name="'+name+'"]').not(this).removeProp("hasbeenpreviouslychecked"),this.hasbeenpreviouslychecked?(this.checked=!1,$(this).removeProp("hasbeenpreviouslychecked")):this.hasbeenpreviouslychecked=!0})),$(".apsolu-attendance-edit-enrolments").click((function(event){event.preventDefault();var popup=$("#apsolu-attendance-popup");0==popup.length&&($("#page-footer").append('<div id="apsolu-attendance-popup"></div>'),popup=$("#apsolu-attendance-popup")),data=new Object,data.userid=$(this).data("userid"),data.courseid=$(this).data("courseid"),data.enrolid=$(this).data("enrolid"),data.statusid=$(this).data("statusid"),data.roleid=$(this).data("roleid"),$.ajax({url:M.cfg.wwwroot+"/local/apsolu/attendance/ajax/edit_enrolment.php",type:"POST",data:data,dataType:"json"}).done((function(result){try{$("#apsolu-attendance-popup").html(result.form),apsolu_attendance_handle_edit_enrolments_form()}catch(e){console.log(e)}})),popup.css({backgroundColor:"#EEEEEE",padding:".5em",cursor:"default",maxWidth:"50%",textAlign:"justify"}),popup.popup("show")}))},setupcourse:function(){var btn1=document.getElementById("block-apsolu-course-edit-enrol-a"),btn2=document.getElementById("block-apsolu-course-edit-attendance-a");if(btn1||btn2){var box=document.getElementById("page-content");if(box){var li,ul=document.createElement("ul");ul.className="list-inline text-center";for(var elements=[btn1,btn2],i=0;i<elements.length;i++)elements[i]&&((li=document.createElement("li")).className="list-inline-item my-2",li.append(elements[i].cloneNode(!0)),ul.append(li));box.prepend(ul)}}}}}));

//# sourceMappingURL=attendance.min.js.map