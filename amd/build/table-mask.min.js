define("local_apsolu/table-mask",["jquery","local_apsolu/preference","core/notification"],(function($,UserRepository,Notification){return{initialise:function(force){if(void 0!==apsolu_table_mask_preferences&&!force)return;var apsolu_table_mask_preferences={};let restoreHtml='<a class="restore-columns btn btn-default btn-condensed">Colonnes cach√©es : cliquez ici pour les restaurer</a>';$(".apsolu-mask-wrapper > table").before(restoreHtml),$(".apsolu-mask-wrapper > table").after(restoreHtml),$(".restore-columns").hide(),UserRepository.getUserPreferences("apsolu_maskable_config").then((value=>{value&&value.preferences[0].value&&(apsolu_table_mask_preferences=JSON.parse(value.preferences[0].value),$(".apsolu-mask-wrapper").each((function(){let $wrapper=$(this),wrapperName=$wrapper.data("mask-name");wrapperName&&apsolu_table_mask_preferences[wrapperName]&&apsolu_table_mask_preferences[wrapperName].forEach((function(columnName){let $cell=$wrapper.find("th[data-mask-name="+columnName+"]");if($cell.length<=0)return;let colIndex=$($cell[0]).data("column"),useHeaderChildIndex=!1;void 0!==colIndex&&void 0!==colIndex||(colIndex=$cell[0].cellIndex,useHeaderChildIndex=!0),$wrapper.find("tbody tr td:nth-child("+(colIndex+1)+")").addClass("hide-col"),useHeaderChildIndex?$wrapper.find("thead tr th:nth-child("+(colIndex+1)+")").addClass("hide-col"):($wrapper.find("thead tr th[data-column="+colIndex+"]").addClass("hide-col"),$wrapper.find("thead tr td[data-column="+colIndex+"]").addClass("hide-col")),$wrapper.find(".restore-columns").show()}))})))})).catch(Notification),$('.apsolu-mask-wrapper thead th:not(".no-mask")').each((function(){let content=$(this).html();$(this).html("<div class='d-flex m-0 p-0'><div class='flex-grow-1'>"+content+"</div><div class='hide-column-container'><button class='btn btn-default btn-condensed hide-column p-0' title='Cacher la colonne'><i class='fa fa-eye-slash'></i></button></div></div>")})),$(".hide-column").click((function(){let $cell=$(this).closest("th,td"),$wrapper=$(this).closest(".apsolu-mask-wrapper"),columnName=$cell.data("mask-name"),wrapperName=$wrapper.data("mask-name");wrapperName&&($wrapper=$("[data-mask-name="+wrapperName+"]"));let colIndex=$($cell[0]).data("column"),useHeaderChildIndex=!1;if(void 0!==colIndex&&void 0!==colIndex||(colIndex=$cell[0].cellIndex,useHeaderChildIndex=!0),$wrapper.find("tbody tr td:nth-child("+(colIndex+1)+")").addClass("hide-col"),useHeaderChildIndex?$wrapper.find("thead tr th:nth-child("+(colIndex+1)+")").addClass("hide-col"):($wrapper.find("thead tr th[data-column="+colIndex+"]").addClass("hide-col"),$wrapper.find("thead tr td[data-column="+colIndex+"]").addClass("hide-col")),$wrapper.find(".restore-columns").show(),columnName&&wrapperName){apsolu_table_mask_preferences[wrapperName]||(apsolu_table_mask_preferences[wrapperName]=[]),apsolu_table_mask_preferences[wrapperName].indexOf(columnName)<0&&apsolu_table_mask_preferences[wrapperName].push(columnName),UserRepository.setUserPreference("apsolu_maskable_config",JSON.stringify(apsolu_table_mask_preferences)).catch(Notification)}return!1})),$(".restore-columns").click((function(){let $wrapper=$(this).closest(".apsolu-mask-wrapper"),wrapperName=$wrapper.data("mask-name");return wrapperName&&($wrapper=$("[data-mask-name="+wrapperName+"]"),apsolu_table_mask_preferences[wrapperName]=[],UserRepository.setUserPreference("apsolu_maskable_config",JSON.stringify(apsolu_table_mask_preferences)).catch(Notification)),$wrapper.find(".restore-columns").hide(),$wrapper.find("th, td").removeClass("hide-col"),!1}))}}}));

//# sourceMappingURL=table-mask.min.js.map